<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jupyter Notebook - Python :: TED Developer Documentation</title>
    <link rel="canonical" href="https://docs.ted.europa.eu/SWS/sample_app/jupyter_notebook_python.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/custom.css">
    <link rel="stylesheet" href="../../_/css/vendor/docsearch-2.6.3.css">
        <link rel="apple-touch-icon" sizes="180x180" href="../../_/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../_/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../_/img/icons/favicon-16x16.png">
    <link rel="manifest" href="../../_/img/icons/site.webmanifest">
    <link rel="mask-icon" href="../../_/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="../../_/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="../../_/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="9zNtA8Mxo6eMk-CIvQQbCvXFWjOoAHT6phYIK3saIV4" />
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
    <nav class="navbar">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://docs.ted.europa.eu">
                <img src="../../_/img/ted-logo.svg" class="logo" />
                <span class="navbar-title">TED Developer Documentation</span>
            </a>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <a class="navbar-item" href="https://docs.ted.europa.eu">Home</a>
                <div class="navbar-item has-dropdown is-hoverable">
  <a class="navbar-link" href="#">Products</a>
  <div class="navbar-dropdown">
      <a class="navbar-item" href="../../eforms/latest/index.html">eForms SDK</a>
      <a class="navbar-item" href="../../EPO/latest/index.html">eProcurement Ontology</a>
      <a class="navbar-item" href="../../ESPD-EDM/latest/index.html">ESPD EDM</a>
  </div>
</div>


<div class="navbar-item has-dropdown is-hoverable">
  <a class="navbar-link" href="#">Resources</a>
  <div class="navbar-dropdown">
    <!-- <div class="navbar-item"><b>Publications Ofiice</b></div> -->
    <a class="navbar-item" href="https://github.com/OP-TED/eForms-SDK">eForms SDK on Github</a>
    <a class="navbar-item" href="https://simap.ted.europa.eu/web/simap/eforms">eForms on SIMAP</a>
    <a class="navbar-item" href="https://github.com/eprocurementontology/eprocurementontology">eProcurement
      Ontology</a>
    <a class="navbar-item" href="https://github.com/espd/espd-edm">European Single Procurement Document</a>
    <a class="navbar-item" href="https://op.europa.eu/en/web/eu-vocabularies/e-procurement/tables">eProcurement in
      EU Vocabularies</a>
    <hr class="navbar-divider">
    <!-- <div class="navbar-item"><b>DG GROW</b></div>-->
    <a class="navbar-item" href="https://ec.europa.eu/growth/single-market/public-procurement/digital/eforms_en">About
      eForms</a>
    <!-- <a class="navbar-item" href="https://github.com/eForms/eForms">eForms 2nd consultation</a> -->
  </div>
</div>

<a class="navbar-item" href="https://simap.ted.europa.eu/contact">Helpdesk</a>

                <div class="navbar-item search">
                    <input id="search-input" type="text" placeholder="Search docs">
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="SWS" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">TED Semantic Web Service</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../audience.html">Target Audience</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><span class="separated"><strong>Mapping suite contents</strong></span></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../genref.html">General Reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/methodology.html">Methodology</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/repository-structure.html">Repository structure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/index.html">Mapping suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/mapping-suite-structure.html">Mapping suite package structure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/code-list-resources.html">Code list mappings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/preparing-test-data.html">Data samples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/toolchain.html">Toolchain</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><span class="separated"><strong>Reusing semantic web service artefacts</strong></span></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sa_glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sparql_queries.html">SPARQL Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ms_excel.html">MS Excel</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jupyter_notebook_r.html">Jupyter Notebook - R</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="jupyter_notebook_python.html">Jupyter Notebook - Python</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><span class="separated"><strong>Reference</strong></span></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/versioning.html">Versioning</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
      <div class="context">
          <span class="title dim">Select a product/version</span>
          <span class="version">&nbsp;</span>
      </div>
  <ul class="components">
      <li class="component">
        <a class="title" href="../../eforms/latest/index.html">eForms SDK</a>
        <ul class="versions">
            <li class="version is-latest">
              <a href="../../eforms/latest/index.html">1.10.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.9/index.html">1.9.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.8/index.html">1.8.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.7/index.html">1.7.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.6/index.html">1.6.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.5/index.html">1.5.1</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.4/index.html">1.4.1</a>
            </li>
        </ul>
      </li>
      <li class="component">
        <a class="title" href="../../EPO/latest/index.html">eProcurement Ontology</a>
        <ul class="versions">
            <li class="version is-latest">
              <a href="../../EPO/latest/index.html">4.0.0</a>
            </li>
            <li class="version">
              <a href="../../EPO/3.1/index.html">3.1.0</a>
            </li>
            <li class="version">
              <a href="../../EPO/3.0.1/index.html">3.0.1</a>
            </li>
            <li class="version">
              <a href="../../EPO/2.0.1/index.html">2.0.1</a>
            </li>
            <li class="version">
              <a href="../../EPO/2.0.0/index.html">2.0.0</a>
            </li>
            <li class="version">
              <a href="../../EPO/1.0.0/index.html">1.0.0</a>
            </li>
        </ul>
      </li>
      <li class="component">
        <a class="title" href="../../ESPD-EDM/latest/index.html">ESPD EDM</a>
        <ul class="versions">
            <li class="version is-latest">
              <a href="../../ESPD-EDM/latest/index.html">3.3.0</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/3.2.0/index.html">3.2.0</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/3.1.0/index.html">3.1.0</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/3.0.1/index.html">3.0.1</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/2.1.1/index.html">2.1.1</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/2.1.0/index.html">2.1.0</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/2.0.2/index.html">2.0.2</a>
            </li>
            <li class="version">
              <a href="../../ESPD-EDM/1.0.2/index.html">1.0.2</a>
            </li>
        </ul>
      </li>
  </ul>
</div>    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">TED Semantic Web Service</a></li>
    <li><a href="jupyter_notebook_python.html">Jupyter Notebook - Python</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="6">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Jupyter Notebook - Python</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document shows an example in Python using Jupyter Notebook.
Jupyter Notebook is an application for creating and sharing
computational documents. Python is a programming language for
writing computational documents. To use Jupyter Notebook and Python, it may be
necessary to install some tools and applications to run the Python query on the Cellar database, and display the results in tabular
format.</p>
</div>
<div class="paragraph">
<p>To run the sample application using Python, follow the steps below:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://github.com/OP-TED/ted-rdf-docs/blob/main/notebooks/query_cellar_python.ipynb">Download Jupyter Notebook </a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Download &amp; Install Python 3.8</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Windows 64bit:
<a href="https://www.python.org/ftp/python/3.8.10/python-3.8.10-amd64.exe"><span class="underline">download</span></a></p>
</li>
<li>
<p>Windows 86bit:
<a href="https://www.python.org/ftp/python/3.8.10/python-3.8.10.exe"><span class="underline">download</span></a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Open the Jupyter Notebook file with the code editor</p>
</li>
<li>
<p>In the code editor, select the Python interpreter that was installed in the previous step</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/user_manual/jupyter_notebook/image1.png" alt="image" width="817" height="204">
</div>
<div class="title">Figure 1. Interpreter selection</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Install dependencies</p>
<div class="ulist">
<ul>
<li>
<p>Use OS command line and run the following command</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">pip3 install sparqlwrapper pandas Jinja2 matplotlib</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
After installation, restart the kernel from Jupyter Notebook to update it with new dependencies. This can be done by clicking on the "Restart" button in the code editor.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Run all Jupyter Notebook Cells</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/user_manual/jupyter_notebook/image2.png" alt="image" width="501" height="84">
</div>
<div class="title">Figure 2. Button that runs all cells</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>After running all the cells in the Jupyter Notebook successfully, the results table can be viewed:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/user_manual/jupyter_notebook/image3.png" alt="image" width="987" height="420">
</div>
<div class="title">Figure 3. Results table</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_explaining_the_query"><a class="anchor" href="#_explaining_the_query"></a>Explaining the query</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Question: Who are the winners for a given date?</strong></p>
</div>
<div class="paragraph">
<p>This SPARQL query aims to retrieve information about the winners of procurement lots for a specific date ("20230905" or 05-09-2023). It does so by specifying a value for the publication date, and then querying the RDF data based on that value. The query returns information about the lots, the organizations that won them, and details about the awarded amounts and currencies.</p>
</div>
<div class="paragraph">
<p>This query is composed of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Prefix section: used to define short aliases (prefixes) for long URIs (Uniform Resource Identifiers).</p>
<div class="literalblock">
<div class="content">
<pre>PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX org: &lt;http://www.w3.org/ns/org#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;</pre>
</div>
</div>
</li>
<li>
<p>The Select section: responsible for specifying which variables or values are to be retrieved from the dataset.</p>
<div class="literalblock">
<div class="content">
<pre>SELECT DISTINCT
?WinnerLegalName
(SAMPLE(?WinnerCountryCode) as ?WinnereCountryCodeURI)
(SUM(?AwardedValue) as ?TotalAwardedValue)
(?AwardedValueCurrency as ?AwardedValueCurrencyURI)</pre>
</div>
</div>
</li>
<li>
<p>The Where section: used to define the specific patterns and conditions that the data in the dataset must match in order to be included in the query result. In this example we have:</p>
<div class="ulist">
<ul>
<li>
<p>Specifying specific filters for output</p>
<div class="literalblock">
<div class="content">
<pre>VALUES ?NoticePublicationDate {
    "20230905"
}
FILTER(LANG(?WinnerLegalName) = 'en')</pre>
</div>
</div>
</li>
<li>
<p>Defining notice according to EPO ontology</p>
<div class="literalblock">
<div class="content">
<pre>?Notice a epo:Notice;
        epo:hasPublicationDate ?NoticePublicationDate ;
        epo:refersToLot ?Lot .</pre>
</div>
</div>
</li>
<li>
<p>Defining lot and lot award outcome according to EPO ontology</p>
<div class="literalblock">
<div class="content">
<pre>?Lot a epo:Lot.
?LotAwardOutcome epo:describesLot ?Lot;
                 a epo:LotAwardOutcome;
                 epo:comprisesTenderAwardOutcome ?TenderAwardOutcome.
?TenderAwardOutcome a epo:TenderAwardOutcome;
                    epo:indicatesAwardOfLotToWinner / epo:playedBy ?Winner.</pre>
</div>
</div>
</li>
<li>
<p>Defining the winner according to EPO ontology</p>
<div class="literalblock">
<div class="content">
<pre>?Winner a org:Organization;
        epo:hasLegalName ?WinnerLegalName .
OPTIONAL {
    ?Winner cccev:registeredAddress / epo:hasCountryCode ?WinnerCountryCode.
}</pre>
</div>
</div>
</li>
<li>
<p>Defining award value and currency according to EPO ontology</p>
<div class="literalblock">
<div class="content">
<pre>?MonetaryValue a epo:MonetaryValue;
               epo:hasAmountValue ?AwardedValue;
               epo:hasCurrency ?AwardedValueCurrency .</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The Group By section: used to group the results by a specific variable. In the example above group by means that the results will be grouped by the winner legal name and the awarded value currency:</p>
<div class="literalblock">
<div class="content">
<pre>GROUP BY ?WinnerLegalName ?AwardedValueCurrency</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The query retrieves:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The legal name of the winner</p>
</li>
<li>
<p>The winners country code as URI</p>
</li>
<li>
<p>The value awarded to winner</p>
</li>
<li>
<p>The currency of the awarded value as URI</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The notice publication date and winner legal name language can be changed to create other queries. To do this, change the following section:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>VALUES ?NoticePublicationDate {
    "20230905"
}
FILTER(LANG(?WinnerLegalName) = 'en')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Existing value for publication date in example above:</p>
<div class="literalblock">
<div class="content">
<pre>"20230905"</pre>
</div>
</div>
</li>
<li>
<p>Existing value for winner legal name language in example above:</p>
<div class="literalblock">
<div class="content">
<pre>'en'</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_query_text"><a class="anchor" href="#_query_text"></a>Query text:</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX org: &lt;http://www.w3.org/ns/org#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;
SELECT DISTINCT
?WinnerLegalName
(SAMPLE(?WinnerCountryCode) as ?WinnereCountryCodeURI)
(SUM(?AwardedValue) as ?TotalAwardedValue)
(?AwardedValueCurrency as ?AwardedValueCurrencyURI)
WHERE {
    VALUES ?NoticePublicationDate {
        "20230905"
    }
    FILTER(LANG(?WinnerLegalName) = 'en')
    ?Notice a epo:Notice;
            epo:hasPublicationDate ?NoticePublicationDate ;
            epo:refersToLot ?Lot .
    ?LotAwardOutcome epo:describesLot ?Lot ;
                     epo:hasAwardedValue ?MonetaryValue ;
                     epo:comprisesTenderAwardOutcome ?TenderAwardOutcome.
    ?TenderAwardOutcome a epo:TenderAwardOutcome;
                        epo:indicatesAwardOfLotToWinner / epo:playedBy ?Winner.
    ?Winner a org:Organization;
            epo:hasLegalName ?WinnerLegalName .
    OPTIONAL {
        ?Winner cccev:registeredAddress / epo:hasCountryCode ?WinnerCountryCode.
    }
    ?MonetaryValue a epo:MonetaryValue;
                   epo:hasAmountValue ?AwardedValue;
                   epo:hasCurrency ?AwardedValueCurrency .
}
GROUP BY ?WinnerLegalName ?AwardedValueCurrency</code></pre>
</div>
</div>
<hr>
<div class="paragraph">
<p>Any comments on the documentation?</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OP-TED/ted-rdf-docs/issues/new/choose">Click here to let us know</a></p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/docsearch-2.6.3.js"></script>
<script src="../../_/js/vendor/search-algolia.js" id="search-script" data-api-key="7bd6f4bbe2cb3188cd99f1625cb00f75" data-api-id="BE8MR7O2G7" data-index-name="ted-docs-idx"></script>
<footer class="footer">
    <div class=columns>
        <div>
  <p>The projects documented in this Developer Documentation Portal are developed and managed by the TED & EU Public Procurement Unit of the Publications Office of the European Union
  <br/>This page was built using a link:https://github.com/OP-TED/antora-eui[fork of the Antora default UI], which is licensed under the terms of the MPL-2.0 license.</p>
</div>
        <div>
            <h3>This website is managed by<h3>
                    <img src="../../_/img/op-logo-with-name.svg" class="logo" />
        </div>
    </div>
</footer>  </body>
</html>
